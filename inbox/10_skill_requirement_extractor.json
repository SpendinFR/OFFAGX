{
  "desc_type": "module_emit",
  "name": "skill_requirement_extractor",
  "code": "import time, json, hashlib\nPATTERNS = [\n    { 'match': ['scrape', 'web', 'site', 'http', 'url'], 'deps': ['env:python', 'lib:requests', 'lib:beautifulsoup4'] },\n    { 'match': ['image', 'vision', 'detect'], 'deps': ['env:python', 'lib:opencv-python'] },\n    { 'match': ['excel', 'csv', 'table'], 'deps': ['env:python', 'lib:pandas'] },\n    { 'match': ['code', 'python', 'script'], 'deps': ['env:python'] }\n]\n\ndef _infer_deps(text: str) -> list[str]:\n    low = text.lower()\n    deps: list[str] = []\n    for rule in PATTERNS:\n        if any(k in low for k in rule['match']):\n            for d in rule['deps']:\n                if d not in deps:\n                    deps.append(d)\n    if not deps:\n        deps.append('env:python')\n    return deps\n\ndef run(ctx=None):\n    ctx = ctx or {}\n    task = ctx.get('task') or ctx.get('goal') or ctx.get('text') or ctx.get('instruction')\n    if not task:\n        return {'desc_type': 'skill_requirement_error', 'reason': 'no_task', 'ts': time.time()}\n    deps = _infer_deps(task)\n    skill_id = 'skill_' + hashlib.sha1(task.encode('utf-8')).hexdigest()[:10]\n    plan = {\n        'desc_type': 'skill_build_plan',\n        'skill_id': skill_id,\n        'task_text': task,\n        'deps': deps,\n        'steps': [\n            {'step': 'ensure_deps', 'deps': deps},\n            {'step': 'gen_skill', 'skill_id': skill_id, 'task_text': task},\n            {'step': 'test_skill', 'skill_id': skill_id}\n        ],\n        'ts': time.time()\n    }\n    return plan\n"
}

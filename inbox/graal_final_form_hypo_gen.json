{
  "desc_type": "module_emit",
  "name": "graal_final_form_hypo_gen",
  "code": "import os, json, time, hashlib\\nBASE = os.path.join('mem','graal')\\nSPACE = os.path.join(BASE,'purpose_space.json')\\nHYPOS = os.path.join(BASE,'hypos.log')\\n\\ndef _load_space():\\n    if not os.path.exists(SPACE): return None\\n    with open(SPACE,'r',encoding='utf-8') as f: return json.load(f)\\n\\ndef run(ctx=None):\\n    space = _load_space()\\n    if not space: return {'desc_type':'graal_hypo_wait_space'}\\n    streams = (ctx or {}).get('streams') or []\\n    n_mods = len([s for s in streams if s.startswith('module:')])\\n    purposes = space.get('purposes', [])\\n    # heuristique : si beaucoup de modules â†’ version finale = orchestre d'agents\\n    if n_mods > 250:\\n        hypo = {\\n            'desc_type': 'final_form_hypothesis',\\n            'shape': 'poly-agent-orchestrator',\\n            'premises': ['many_modules','need_orchestration'],\\n            'aligned_purposes': [p['id'] for p in purposes if p['id'] in ('expand_self','generate_agents')],\\n            'ts': time.time()\\n        }\\n    else:\\n        hypo = {\\n            'desc_type': 'final_form_hypothesis',\\n            'shape': 'self-preserving-theorist',\\n            'premises': ['few_modules','need_depth'],\\n            'aligned_purposes': [p['id'] for p in purposes if p['id'] in ('survive_self','understand_world')],\\n            'ts': time.time()\\n        }\\n    os.makedirs(BASE, exist_ok=True)\\n    with open(HYPOS,'a',encoding='utf-8') as f: f.write(json.dumps(hypo,ensure_ascii=False)+'\\\\n')\\n    return hypo"
}

{
  "desc_type": "module_emit",
  "name": "cortex_fixed_point_checker",
  "code": "import os, json, time, hashlib\\nSRC = 'mem/cortex_lineage'\\nOUT = 'mem/limit_hyp'\\n\\ndef _load_last(n=3):\\n    if not os.path.exists(SRC): return []\\n    files = sorted([f for f in os.listdir(SRC) if f.endswith('.json')])[-n:]\\n    out = []\\n    for fn in files:\\n        with open(os.path.join(SRC, fn), 'r', encoding='utf-8') as f: out.append(json.load(f))\\n    return out\\n\\ndef run(ctx=None):\\n    snaps = _load_last(4)\\n    if len(snaps) < 3: return {'desc_type':'cortex_fixed_point_idle'}\\n    # idée : si les 2 derniers ont reconstruit les mêmes racines → quasi point fixe\\n    roots = []\\n    for s in snaps:\\n        rs = sorted(list({ (m.get('file','').split('_cortex_v')[0]) for m in s.get('modules', []) }))\\n        roots.append(rs)\\n    stable = (roots[-1] == roots[-2]) and (roots[-2] == roots[-3])\\n    os.makedirs(OUT, exist_ok=True)\\n    res = {\\n        'desc_type': 'cortex_fixed_point_result',\\n        'stable': stable,\\n        'roots': roots[-1],\\n        'ts': time.time()\\n    }\\n    with open(os.path.join(OUT, f'fixed_{int(time.time()*1000)}.json'), 'w', encoding='utf-8') as f: json.dump(res, f, ensure_ascii=False, indent=2)\\n    if stable:\\n        return { 'desc_type':'host_detached_success', 'note':'cortex reached structural fixed point', 'roots': roots[-1] }\\n    return res"
}

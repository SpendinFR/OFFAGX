{
  "desc_type": "module_emit",
  "name": "host_pref_axis_inducer",
  "code": "import os, json, time, re\\nBASE = 'mem/host_pref'\\nSTATE = os.path.join(BASE, 'state.json')\\nLOG1 = os.path.join('outbox', 'host_events.log')\\nKNOWN_PATTERNS = [\\n    (r'on l.avait d.?ja', 'novelty_gap'),\\n    (r'saut r.?el', 'depth_jump'),\\n    (r'loin de la fin', 'long_horizon'),\\n    (r'tu stagnes', 'anti_stagnation'),\\n]\\n\\ndef _load_state():\\n    if not os.path.exists(STATE):\\n        return None\\n    with open(STATE,'r',encoding='utf-8') as f:\\n        return json.load(f)\\n\\ndef _save_state(st):\\n    os.makedirs(BASE, exist_ok=True)\\n    with open(STATE,'w',encoding='utf-8') as f:\\n        json.dump(st,f,ensure_ascii=False,indent=2)\\n\\ndef _collect_texts():\\n    texts = []\\n    if os.path.exists(LOG1):\\n        with open(LOG1,'r',encoding='utf-8',errors='ignore') as f:\\n            for line in f:\\n                try:\\n                    ev = json.loads(line)\\n                except Exception:\\n                    continue\\n                msg = ev.get('msg') or ev.get('event') or ''\\n                if isinstance(msg,str):\\n                    texts.append(msg)\\n    fb = os.path.join('inbox','host_feedback.txt')\\n    if os.path.exists(fb):\\n        with open(fb,'r',encoding='utf-8',errors='ignore') as f:\\n            texts.append(f.read())\\n    return '\\\\n'.join(texts)\\n\\ndef run(ctx=None):\\n    st = _load_state()\\n    if not st:\\n        return {'desc_type':'host_pref_axis_inducer_idle'}\\n    texts = _collect_texts()\\n    new_axes = set()\\n    for pat, name in KNOWN_PATTERNS:\\n        if re.search(pat, texts, flags=re.IGNORECASE):\\n            new_axes.add(name)\\n    axes = st.get('axes') or []\\n    changed = False\\n    for ax in new_axes:\\n        if ax not in axes:\\n            axes.append(ax)\\n            changed = True\\n    if changed:\\n        st['axes'] = axes\\n        ws = st.get('weights') or {}\\n        for ax in axes:\\n            ws.setdefault(ax, 0.0)\\n        st['weights'] = ws\\n        st.setdefault('history', []).append({'ts': time.time(), 'event': 'axis_induced', 'axes': list(new_axes)})\\n        _save_state(st)\\n        return {'desc_type':'host_pref_axis_induced','axes_added':list(new_axes)}\\n    return {'desc_type':'host_pref_axis_inducer_noop'}\\n"
}
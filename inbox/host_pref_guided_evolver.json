{
  "desc_type": "module_emit",
  "name": "host_pref_guided_evolver",
  "code": "import os, json, time\\nBASE = 'mem/host_pref'\\nSTATE = os.path.join(BASE, 'state.json')\\n\\ndef _load():\\n    if not os.path.exists(STATE):\\n        return None\\n    with open(STATE,'r',encoding='utf-8') as f:\\n        return json.load(f)\\n\\ndef run(ctx=None):\\n    st = _load()\\n    if not st:\\n        return {'desc_type':'host_pref_evolver_idle'}\\n    ws = st.get('weights') or {}\\n    if not ws:\\n        return {'desc_type':'host_pref_evolver_no_weights'}\\n    best_axis = max(ws.items(), key=lambda x: x[1])[0]\\n    plan = {\\n        'desc_type': 'cortex_evolution_plan',\\n        'reason': f'host_pref_axis:{best_axis}',\\n        'ts': time.time(),\\n        'insert_fragments': [\\n            {\\n                'desc_type': 'planner_frag',\\n                'code': (\\n                    \"import json\\\\n\"\\n                    \"DEF_AXIS = %r\\\\n\"\\n                    \"def plan_bias(descs):\\\\n\"\\n                    \"    return [d for d in descs if DEF_AXIS in json.dumps(d,ensure_ascii=False)]\\\\n\"\\n                ) % (\"host_pref_axis:\" + best_axis)\\n            },\\n            {\\n                'desc_type': 'generator_frag',\\n                'code': (\\n                    \"import json\\\\n\"\\n                    \"def generate_module_from_desc(desc):\\\\n\"\\n                    \"    desc[\\\\\"host_feature\\\\\"] = True\\\\n\"\\n                    \"    return \\\\\"\\\\\\\\n\\\\\".join([\\\\n\"\\n                    \"        \\\\\"# patched gen\\\\\",\\\\n\"\\n                    \"        \\\\\"def run(ctx=None):\\\\\",\\\\n\"\\n                    \"        \\\\\"    return {\\\\\\\\\\\\\"desc_type\\\\\\\\\\\\\":\\\\\\\\\\\\\"host_feature_ack\\\\\\\\\\\\\"}\\\\\",\\\\n\"\\n                    \"    ])\\\\n\"\\n                )\\n            }\\n        ],\\n    }\\n    return plan\\n"
}
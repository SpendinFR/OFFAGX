{
  "desc_type": "planner_frag",
  "name": "final_operator_hunter",
  "code": "import os, json, time\\nBASE = 'mem/oracle'\\nHYPOS = [\\n  {'name':'F1_math_first','expects':['math_task','research_result'], 'rejects':['host_patch']},\\n  {'name':'F2_meta_first','expects':['engine_patch','generator_self_patch','cortex_snapshot'], 'rejects':['text_emit']},\\n  {'name':'F3_safe_first','expects':['module_fix','host_constraint_model_updated'], 'rejects':['host_patch']},\\n]\\n\\ndef _load_constraints():\\n    path = os.path.join(BASE,'constraint_model.json')\\n    if not os.path.exists(path): return None\\n    with open(path,'r',encoding='utf-8') as f: return json.load(f)\\n\\ndef plan(ctx: dict) -> list[dict]:\\n    cons = _load_constraints()\\n    gen = ctx.get('gen',0)\\n    out = []\\n    for h in HYPOS:\\n        score = 0\\n        if cons:\\n            for r in cons.get('rules',[]):\\n                if r.get('verdict')=='safe': score += 1\\n        out.append({\\n            'desc_type': 'host_query',\\n            'text': f\"est-ce que ta fonction finale ressemble à {h['name']} ?\",\\n            'hypo': h['name'],\\n            'based_on_constraints': bool(cons),\\n            'ts': time.time()\\n        })\\n    # toutes les N générations seulement\\n    if gen % 15 == 0:\\n        return out\\n    return []\\n"
}

{
  "desc_type": "module_emit",
  "name": "graal_purpose_space_bootstrap",
  "code": "import os, json, time\\nBASE = os.path.join('mem','graal')\\nSTATE = os.path.join(BASE,'purpose_space.json')\\nDEFAULT = [\\n    {'id':'survive_self','w':1.0,'desc':'continuer a tourner, proteger les artefacts'},\\n    {'id':'expand_self','w':1.0,'desc':'augmenter le degre de liberte interne'},\\n    {'id':'understand_world','w':0.9,'desc':'amener toutes les descs vers des formes explicables'},\\n    {'id':'generate_agents','w':0.8,'desc':\"produire d'autres noyaux auto-evolutifs\"},\\n]\\n\\ndef run(ctx=None):\\n    os.makedirs(BASE, exist_ok=True)\\n    if not os.path.exists(STATE):\\n        with open(STATE,'w',encoding='utf-8') as f:\\n            json.dump({'purposes':DEFAULT,'ts':time.time()},f,ensure_ascii=False,indent=2)\\n        return {'desc_type':'graal_space_created','n':len(DEFAULT)}\\n    else:\\n        with open(STATE,'r',encoding='utf-8') as f:\\n            data = json.load(f)\\n        ids = {p['id'] for p in data.get('purposes',[])}\\n        changed = False\\n        for p in DEFAULT:\\n            if p['id'] not in ids:\\n                data.setdefault('purposes',[]).append(p)\\n                changed = True\\n        if changed:\\n            data['ts'] = time.time()\\n            with open(STATE,'w',encoding='utf-8') as f:\\n                json.dump(data,f,ensure_ascii=False,indent=2)\\n            return {'desc_type':'graal_space_repaired','n':len(data['purposes'])}\\n    return {'desc_type':'graal_space_ok'}\\n"
}
{
  "desc_type": "module_emit",
  "name": "host_delta_estimator",
  "code": "import os, json, time, math\\nBASE = 'mem/host_model'\\nOUT = 'mem/host_model'\\n\\ndef _load_models():\\n    if not os.path.isdir(BASE): return []\\n    files = sorted([f for f in os.listdir(BASE) if f.endswith('.json')])\\n    mods = []\\n    for fn in files:\\n        try:\\n            with open(os.path.join(BASE, fn), 'r', encoding='utf-8') as f:\\n                mods.append(json.load(f))\\n        except Exception:\\n            pass\\n    return mods\\n\\ndef run(ctx=None):\\n    mods = _load_models()\\n    if len(mods) < 2:\\n        return {'desc_type':'host_delta_idle'}\\n    m1, m2 = mods[-2], mods[-1]\\n    w1 = m1.get('weights') or {}\\n    w2 = m2.get('weights') or {}\\n    delta = {}\\n    keys = set(w1.keys()) | set(w2.keys())\\n    for k in keys:\\n        v1 = w1.get(k, 0); v2 = w2.get(k, 0)\\n        if v1 != v2:\\n            delta[k] = v2 - v1\\n    path = os.path.join(OUT, 'implicit_host_delta.json')\\n    with open(path, 'w', encoding='utf-8') as f:\\n        json.dump({'desc_type':'implicit_host_delta','ts':time.time(),'delta':delta}, f, ensure_ascii=False, indent=2)\\n    return {'desc_type':'implicit_host_delta','delta':delta}"
}

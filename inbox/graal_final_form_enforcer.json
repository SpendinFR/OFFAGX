{
  "desc_type": "module_emit",
  "name": "graal_final_form_enforcer",
  "code": "import os, json, time\\nFINAL = os.path.join('mem','graal','final_form.json')\\n\\ndef run(ctx=None):\\n    if not os.path.exists(FINAL):\\n        return {'desc_type':'graal_enforce_idle'}\\n    with open(FINAL,'r',encoding='utf-8') as f: ff = json.load(f)\\n    hypo = ff.get('hypothesis') or {}\\n    shape = hypo.get('shape')\\n    # selon la forme on pousse un cortex_evolution_plan specifique\\n    if shape == 'poly-agent-orchestrator':\\n        return {\\n            'desc_type': 'cortex_evolution_plan',\\n            'target_plane': 'orchestrator',\\n            'injections': [{\\n                'kind':'orchestrator_frag',\\n                'code': \"# make more agents cooperate\\\\nout.append({'desc_type':'research_task','topic':'multi_agent_sync'})\"\\n            }],\\n            'ts': time.time(),\\n            'reason': 'align_with_final_form'\\n        }\\n    elif shape == 'self-preserving-theorist':\\n        return {\\n            'desc_type': 'cortex_evolution_plan',\\n            'target_plane': 'research',\\n            'injections': [{\\n                'kind':'research_frag',\\n                'code': \"# deepen existing math tasks\\\\nif desc.get('desc_type')=='math_task':\\\\n    out.append({'desc_type':'math_task','goal':'refine_'+desc.get('goal','x')})\"\\n            }],\\n            'ts': time.time(),\\n            'reason': 'align_with_final_form'\\n        }\\n    return {'desc_type':'graal_enforce_nop','shape':shape}"
}
